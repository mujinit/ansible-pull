# - name: Add Google Chrome repository
#   ansible.builtin.apt_key:
#     url: https://dl.google.com/linux/linux_signing_key.pub
#     state: present

# - name: Add Google Chrome repository to apt sources
#   ansible.builtin.apt_repository:
#     repo: 'deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main'
#     state: present

# - name: Update apt cache
#   ansible.builtin.apt:
#     update_cache: yes

# - name: Install or update Google Chrome
#   ansible.builtin.apt:
#     name: google-chrome-stable
#     state: latest

# - name: Ensure Chrome is regularly updated via cron job
#   ansible.builtin.cron:
#     name: "Regular Chrome Update"
#     minute: "0"
#     hour: "2"
#     job: "/usr/bin/ansible-playbook /path/to/update_chrome.yml"

- name: Check if Chrome is running
  ansible.builtin.shell: pgrep -x "chrome"
  register: chrome_status
  ignore_errors: yes

- name: Force close Chrome if it is running
  ansible.builtin.shell: pkill -9 chrome
  when: chrome_status.rc == 0

- name: Update Google Chrome to the latest version
  ansible.builtin.apt:
    name: google-chrome-stable
    state: latest
  register: chrome_update

- name: Open Google Chrome
  ansible.builtin.shell: google-chrome &
  when: chrome_update is changed